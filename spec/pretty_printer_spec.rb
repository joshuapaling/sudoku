require 'spec_helper'

describe Sudoku::PrettyPrinter do
  before :each do
    @game = Sudoku::Game.new(EMPTY)
    @pp = Sudoku::PrettyPrinter.new
  end

  describe '#color_print_game' do
    it 'prints in color' do
      @game = Sudoku::Game.new(EASY1)
      # best way to test this method is just visually look at output
      # But disable it for now cos we don't want to see it every time we run tests
      # puts @pp.color_print_game(@game)
    end
  end

  describe '#print_game' do
    it "connects rows correctly" do
      expected = <<EOT
|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | ` ` ` |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | ` 1 ` |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | ` ` ` |%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|%%%%%%%|%%%%%%%|%%%%%%%|%|
EOT

      @game.cell_at(9,1).eliminate_candidates([2,3,4,5,6,7,8,9])
      expect(@pp.print_game(@game)).to eq(expected)

    end
  end

  describe '#print_row' do
    it "connects cells correctly" do
      expected = <<EOT
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%|
|%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%|
|%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%|
EOT
      row = @game.row(1)
      expect(@pp.print_row(row)).to eq(expected)
    end

    it "displays row with solved values correctly" do
      expected = <<EOT
|%|-------|-------|-------|%|-------|-------|-------|%|-------|-------|-------|%|
|%| ` ` ` | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | 1 2 3 |%| 1 2 3 | 1 2 3 | ` ` ` |%|
|%| ` 5 ` | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | 4 5 6 |%| 4 5 6 | 4 5 6 | ` 1 ` |%|
|%| ` ` ` | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | 7 8 9 |%| 7 8 9 | 7 8 9 | ` ` ` |%|
EOT
      @game.cell_at(1,1).eliminate_candidates([1,2,3,4,6,7,8,9])
      @game.cell_at(9,1).eliminate_candidates([2,3,4,5,6,7,8,9])
      row = @game.row(1)
      expect(@pp.print_row(row)).to eq(expected)
    end
  end

  describe '#print_cell' do
    it 'works for cell with all candidates' do
      expected = <<EOT
-------|
 1 2 3 |
 4 5 6 |
 7 8 9 |
EOT
      cell = Sudoku::Cell.new(1, 1, nil, @game)
      expect(@pp.print_cell(cell)).to eq(expected)
    end

    it 'works for cell with some candidates' do
      expected = <<EOT
-------|
 - 2 - |
 4 5 6 |
 - - 9 |
EOT
      cell = Sudoku::Cell.new(1, 1, nil, @game)
      cell.eliminate_candidates([1,3,7,8])
      expect(@pp.print_cell(cell)).to eq(expected)
    end

    it 'works for solved cell' do
      expected = <<EOT
-------|
 ` ` ` |
 ` 9 ` |
 ` ` ` |
EOT
      cell = Sudoku::Cell.new(1, 1, 9, @game)
      expect(@pp.print_cell(cell)).to eq(expected)
    end

  end
end
